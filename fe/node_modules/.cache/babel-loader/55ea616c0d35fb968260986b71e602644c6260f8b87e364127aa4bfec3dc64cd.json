{"ast":null,"code":"import\"./ChatSideBarItem.scss\";import{useEffect,useRef,useState}from\"react\";import NotificationDialog from\"../notification_dialog/NotificationDialog\";import{Link}from\"react-router-dom\";import{deleteChatBot,updateChatBot}from\"../../services/ChatBotService\";import{actionDeleteChat,actionUpdateChat}from\"../../store/actions/ChatAction\";import{decryptToken}from\"../../utils/Functions\";import{useDispatch}from\"react-redux\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ChatSideBarItem(_ref){let{title,botId,chatId,index,selectedIndex,handleSelected}=_ref;const[showOptions,setShowOptions]=useState(false);const[showRename,setShowRename]=useState(false);const[titleChat,setTitleChat]=useState(title);const[showDeleteDialog,setShowDeleteDialog]=useState(false);const dropdownRef=useRef(null);const renameRef=useRef(null);const accessToken=decryptToken(localStorage.getItem('access_token'));const dispatch=useDispatch();useEffect(()=>{if(showOptions){document.addEventListener(\"mousedown\",handleClickOutside);}else{document.removeEventListener(\"mousedown\",handleClickOutside);}if(showRename){document.addEventListener(\"mousedown\",handleClickOutsideInput);}else{document.removeEventListener(\"mousedown\",handleClickOutsideInput);}return()=>{document.removeEventListener(\"mousedown\",handleClickOutside);document.removeEventListener(\"mousedown\",handleClickOutsideInput);};},[showOptions,showRename]);useEffect(()=>{if(showRename&&renameRef.current){renameRef.current.focus();}},[showRename]);const handleClickOutsideInput=event=>{if(renameRef.current&&!renameRef.current.contains(event.target)){toggleShowRename();handleRename();}};const handleClickOutside=event=>{if(dropdownRef.current&&!dropdownRef.current.contains(event.target)){toggleShowOptions();}};const handleKeyDown=event=>{if(event.key==='Enter'){toggleShowRename();handleRename();}};const handleRename=async()=>{try{const data=await updateChatBot(titleChat,accessToken,botId,chatId);dispatch(actionUpdateChat(data));}catch(error){console.error('Error Rename:',error.message);}};const confirmDelete=async()=>{try{const data=await deleteChatBot(accessToken,botId,chatId);dispatch(actionDeleteChat(chatId));toggleShowDeleteDialog();}catch(error){console.error('Error Rename:',error.message);}};const onChangeTitle=e=>{setTitleChat(e.target.value);};const toggleShowDeleteDialog=()=>{setShowDeleteDialog(!showDeleteDialog);};const toggleShowRename=()=>{// renameRef.current.focus();\nsetShowRename(!showRename);setShowOptions(false);};const toggleShowOptions=()=>{setShowOptions(!showOptions);};return/*#__PURE__*/_jsx(Link,{to:\"/bots/\".concat(botId,\"/chat/\").concat(chatId),className:\"link\",children:/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleSelected(index),className:\"chat_bar__item \".concat(index==selectedIndex?\"chat_bar__item--selected\":\"\"),children:[/*#__PURE__*/_jsx(\"span\",{className:\"item_title\",children:titleChat}),/*#__PURE__*/_jsxs(\"div\",{className:\"options_dropdown\",ref:dropdownRef,children:[/*#__PURE__*/_jsx(\"div\",{onClick:toggleShowOptions,className:\"btn_option\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-three-dots\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"dropdown-content \".concat(showOptions?\"dropdown-content--show\":\"\",\" \"),children:[/*#__PURE__*/_jsxs(\"div\",{onClick:toggleShowRename,className:\"dropdown-btn\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-pencil-fill\"}),/*#__PURE__*/_jsx(\"span\",{className:\"dropdown-btn-title\",children:\"Rename\"})]}),/*#__PURE__*/_jsxs(\"div\",{onClick:toggleShowDeleteDialog,className:\"dropdown-btn btn-delete\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-trash-fill\"}),/*#__PURE__*/_jsx(\"span\",{className:\"dropdown-btn-title\",children:\"Delete\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"rename__container \".concat(showRename?\"rename__container--show\":\"\"),children:/*#__PURE__*/_jsx(\"input\",{ref:renameRef,onKeyDown:handleKeyDown,onChange:onChangeTitle,value:titleChat,type:\"text\",className:\"input_rename\"})}),showDeleteDialog&&/*#__PURE__*/_jsx(NotificationDialog,{confirm:confirmDelete,title:\"Delete chat?\",mesage:\"This action will delete \\\"\".concat(titleChat,\"\\\"\"),cancelDialog:toggleShowDeleteDialog})]},chatId)},chatId);}","map":{"version":3,"names":["useEffect","useRef","useState","NotificationDialog","Link","deleteChatBot","updateChatBot","actionDeleteChat","actionUpdateChat","decryptToken","useDispatch","jsx","_jsx","jsxs","_jsxs","ChatSideBarItem","_ref","title","botId","chatId","index","selectedIndex","handleSelected","showOptions","setShowOptions","showRename","setShowRename","titleChat","setTitleChat","showDeleteDialog","setShowDeleteDialog","dropdownRef","renameRef","accessToken","localStorage","getItem","dispatch","document","addEventListener","handleClickOutside","removeEventListener","handleClickOutsideInput","current","focus","event","contains","target","toggleShowRename","handleRename","toggleShowOptions","handleKeyDown","key","data","error","console","message","confirmDelete","toggleShowDeleteDialog","onChangeTitle","e","value","to","concat","className","children","onClick","ref","onKeyDown","onChange","type","confirm","mesage","cancelDialog"],"sources":["/Users/huudan/Development/chatbot.com/fe/src/components/chat_side_bar_item/ChatSideBarItem.js"],"sourcesContent":["import \"./ChatSideBarItem.scss\"\nimport {useEffect, useRef, useState} from \"react\";\nimport NotificationDialog from \"../notification_dialog/NotificationDialog\";\nimport {Link} from \"react-router-dom\";\nimport {deleteChatBot, updateChatBot} from \"../../services/ChatBotService\";\nimport {actionDeleteChat, actionUpdateChat} from \"../../store/actions/ChatAction\";\nimport {decryptToken} from \"../../utils/Functions\";\nimport {useDispatch} from \"react-redux\";\n\nexport default function ChatSideBarItem({title,botId, chatId,index, selectedIndex, handleSelected}) {\n    const [showOptions, setShowOptions] = useState(false);\n    const [showRename, setShowRename] = useState(false);\n    const [titleChat, setTitleChat] = useState(title)\n    const [showDeleteDialog, setShowDeleteDialog] = useState(false);\n    const dropdownRef = useRef(null);\n    const renameRef = useRef(null);\n    const accessToken = decryptToken(localStorage.getItem('access_token'));\n    const dispatch = useDispatch();\n    useEffect(() => {\n        if (showOptions) {\n            document.addEventListener(\"mousedown\", handleClickOutside);\n        } else {\n            document.removeEventListener(\"mousedown\", handleClickOutside);\n        }\n        if(showRename){\n            document.addEventListener(\"mousedown\", handleClickOutsideInput);\n        }else{\n            document.removeEventListener(\"mousedown\", handleClickOutsideInput);\n        }\n        return () => {\n            document.removeEventListener(\"mousedown\", handleClickOutside);\n            document.removeEventListener(\"mousedown\", handleClickOutsideInput);\n        };\n    }, [showOptions,showRename]);\n    useEffect(() => {\n        if (showRename && renameRef.current) {\n            renameRef.current.focus();\n        }\n    }, [showRename]);\n    const handleClickOutsideInput = (event)=>{\n        if (renameRef.current && !renameRef.current.contains(event.target)) {\n            toggleShowRename();\n            handleRename();\n        }\n    }\n    const handleClickOutside = (event) => {\n        if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {\n            toggleShowOptions();\n        }\n    };\n    const handleKeyDown = (event) => {\n        if (event.key === 'Enter') {\n            toggleShowRename();\n            handleRename();\n        }\n    };\n\n    const handleRename = async () => {\n        try {\n            const data = await updateChatBot(titleChat, accessToken, botId,chatId)\n            dispatch(actionUpdateChat(data));\n        } catch (error) {\n            console.error('Error Rename:', error.message);\n        }\n    }\n    const confirmDelete = async () => {\n        try {\n            const data = await deleteChatBot(accessToken, botId,chatId)\n            dispatch(actionDeleteChat(chatId));\n            toggleShowDeleteDialog();\n        } catch (error) {\n            console.error('Error Rename:', error.message);\n        }\n    }\n    const onChangeTitle = (e) => {\n        setTitleChat(e.target.value);\n    };\n    const toggleShowDeleteDialog = () => {\n        setShowDeleteDialog(!showDeleteDialog);\n    }\n    const toggleShowRename = () => {\n        // renameRef.current.focus();\n        setShowRename(!showRename);\n        setShowOptions(false);\n    }\n    const toggleShowOptions = () => {\n        setShowOptions(!showOptions);\n    }\n    return (\n        <Link key={chatId}  to={`/bots/${botId}/chat/${chatId}`} className={\"link\"}>\n            <div key={chatId} onClick={()=>handleSelected(index)} className={`chat_bar__item ${index == selectedIndex ? \"chat_bar__item--selected\":\"\"}`}>\n                <span className=\"item_title\">{titleChat}</span>\n                <div className=\"options_dropdown\" ref={dropdownRef}>\n                    <div onClick={toggleShowOptions} className=\"btn_option\">\n                        <i className=\"bi bi-three-dots\"></i>\n                    </div>\n                    <div className={`dropdown-content ${showOptions ? \"dropdown-content--show\":\"\"} `}>\n                        <div onClick={toggleShowRename} className=\"dropdown-btn\">\n                            <i className=\"bi bi-pencil-fill\"></i>\n                            <span className={\"dropdown-btn-title\"}>Rename</span>\n                        </div>\n                        <div onClick={toggleShowDeleteDialog} className=\"dropdown-btn btn-delete\">\n                            <i className=\"bi bi-trash-fill\"></i>\n                            <span className={\"dropdown-btn-title\"}>Delete</span>\n                        </div>\n                    </div>\n                </div>\n                <div  className={`rename__container ${showRename ? \"rename__container--show\":\"\"}`}>\n                    <input ref={renameRef} onKeyDown={handleKeyDown} onChange={onChangeTitle} value={titleChat} type=\"text\" className=\"input_rename\"/>\n                </div>\n                {showDeleteDialog && <NotificationDialog confirm={confirmDelete} title={\"Delete chat?\"} mesage={`This action will delete \"${titleChat}\"`} cancelDialog={toggleShowDeleteDialog}/>}\n            </div>\n        </Link>\n    )\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}