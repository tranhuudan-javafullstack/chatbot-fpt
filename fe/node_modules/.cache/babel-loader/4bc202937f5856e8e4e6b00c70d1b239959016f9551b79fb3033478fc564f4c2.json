{"ast":null,"code":"import\"./MyInfo.scss\";import{useDispatch,useSelector}from\"react-redux\";import InputModal from\"../input_modal/InputModal\";import{useEffect,useState}from\"react\";import TextButtonIcon from\"../icon_text_button/TextButtonIcon\";import{changePassword,updateInfo}from\"../../services/UserService\";import{saveUserInfo}from\"../../store/actions/UserAction\";import{decryptToken}from\"../../utils/Functions\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function MyInfo(){var _localStorage$getItem,_localStorage$getItem2;const accessToken=decryptToken((_localStorage$getItem=localStorage.getItem('access_token'))!==null&&_localStorage$getItem!==void 0?_localStorage$getItem:\"\");const refreshToken=decryptToken((_localStorage$getItem2=localStorage.getItem('refresh_token'))!==null&&_localStorage$getItem2!==void 0?_localStorage$getItem2:\"\");const userReducer=useSelector(state=>state.userReducer);const[gender,setGender]=useState(userReducer.gender);const[userName,setUserName]=useState(\"\");const[avatar,setAvatar]=useState(\"\");const[birthDate,setBirthDate]=useState(userReducer.birtDate?userReducer.birtDate.split('T')[0]:\"\");const[firstName,setFirstName]=useState(userReducer.firstName);const[lastName,setLastName]=useState(userReducer.lastName);const[oldPassword,setOldPassword]=useState(\"\");const[newPassword,setNewPassword]=useState(\"\");const dispatch=useDispatch();const[error,setError]=useState(\"\");useEffect(()=>{// if (userReducer.username) {\n//     setUserName(userReducer.username);\n// }\nif(userReducer.avatar){setAvatar(userReducer.avatar);}// if(userReducer.gender) setGender(userReducer.gender);\n// if (userReducer.birth_date) setBirthDate(userReducer.birth_date);\n},[userReducer]);const handleChange=event=>{setGender(event.target.value);};const handleUpdateUser=async()=>{try{// const birthDateISO = new Date(birthDate).toISOString();\nconst userInfo=await updateInfo(firstName,lastName,gender,birthDate,accessToken);dispatch(saveUserInfo(userInfo));}catch(error){console.error('Error fetching user info:',error);}};const handleChangePassword=async()=>{console.log(\"DO DAY\");setError(\"\");if(oldPassword==\"\"||newPassword==\"\"){setError(\"Do not enter current password or new password\");return;}if(oldPassword===newPassword){setError(\"The new password and old password must not be the same\");return;}try{const user=await changePassword(newPassword,oldPassword,accessToken,refreshToken);}catch(error){setError(error.message);console.error('Error change password:',error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"my_account\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bot_page__header\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bot_page__title\",children:/*#__PURE__*/_jsx(\"p\",{className:\"title\",children:\"T\\xE0i kho\\u1EA3n\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bot_page__body my_info--body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"body__header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"avatar\",children:[/*#__PURE__*/_jsx(\"img\",{src:avatar,alt:\"\"}),/*#__PURE__*/_jsx(\"div\",{className:\"btn_edit_avatar\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-pencil-fill\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"body__content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form_input\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"title_form\",children:\"Th\\xF4ng tin ng\\u01B0\\u1EDDi d\\xF9ng\"}),/*#__PURE__*/_jsx(InputModal,{value:firstName?firstName:\"\",onChangeInput:setFirstName,label:\"First name\",placeHolder:\"Enter your first name\"}),/*#__PURE__*/_jsx(InputModal,{value:lastName?lastName:\"\",onChangeInput:setLastName,label:\"Last name\",placeHolder:\"Enter your last name\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form_footer\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"date\",children:\"Ng\\xE0y sinh: \"}),/*#__PURE__*/_jsx(\"input\",{id:\"date\",onChange:e=>setBirthDate(e.target.value),value:birthDate,type:\"date\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"gender\",children:\"Gi\\u1EDBi t\\xEDnh:\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"gender\",value:gender,onChange:handleChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"male\",children:\"nam\"}),/*#__PURE__*/_jsx(\"option\",{value:\"female\",children:\"nu\"})]})]}),/*#__PURE__*/_jsx(TextButtonIcon,{onPress:handleUpdateUser,title:\"Cập nhật\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form_input\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"title_form\",children:\"Thay \\u0111\\u1ED5i m\\u1EADt kh\\u1EA9u\"}),/*#__PURE__*/_jsx(InputModal,{type:\"password\",value:oldPassword,onChangeInput:setOldPassword,label:\"Mật khẩu hiện tại\",placeHolder:\"Nhập mật khẩu hiện tại\"}),/*#__PURE__*/_jsx(InputModal,{type:\"password\",value:newPassword,onChangeInput:setNewPassword,label:\"Mật khẩu mới\",placeHolder:\"Nhập mật khẩu mới\"}),/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:error}),/*#__PURE__*/_jsx(TextButtonIcon,{onPress:handleChangePassword,title:\"cập nhật\"})]})]})]})]});}","map":{"version":3,"names":["useDispatch","useSelector","InputModal","useEffect","useState","TextButtonIcon","changePassword","updateInfo","saveUserInfo","decryptToken","jsx","_jsx","jsxs","_jsxs","MyInfo","_localStorage$getItem","_localStorage$getItem2","accessToken","localStorage","getItem","refreshToken","userReducer","state","gender","setGender","userName","setUserName","avatar","setAvatar","birthDate","setBirthDate","birtDate","split","firstName","setFirstName","lastName","setLastName","oldPassword","setOldPassword","newPassword","setNewPassword","dispatch","error","setError","handleChange","event","target","value","handleUpdateUser","userInfo","console","handleChangePassword","log","user","message","className","children","src","alt","onChangeInput","label","placeHolder","htmlFor","id","onChange","e","type","onPress","title"],"sources":["/Users/huudan/Development/chatbot.com/fe/src/components/my_info/MyInfo.js"],"sourcesContent":["import \"./MyInfo.scss\"\nimport {useDispatch, useSelector} from \"react-redux\";\nimport InputModal from \"../input_modal/InputModal\";\nimport {useEffect, useState} from \"react\";\nimport TextButtonIcon from \"../icon_text_button/TextButtonIcon\";\nimport {changePassword, updateInfo} from \"../../services/UserService\";\nimport {saveUserInfo} from \"../../store/actions/UserAction\";\nimport {decryptToken} from \"../../utils/Functions\";\n\nexport default function MyInfo() {\n    const accessToken = decryptToken(localStorage.getItem('access_token') ?? \"\");\n    const refreshToken = decryptToken(localStorage.getItem('refresh_token') ?? \"\");\n    const userReducer = useSelector((state) => state.userReducer);\n    const [gender, setGender] = useState(userReducer.gender);\n    const [userName, setUserName] = useState(\"\");\n    const [avatar, setAvatar] = useState(\"\");\n    const [birthDate, setBirthDate] = useState(userReducer.birtDate ? userReducer.birtDate.split('T')[0] : \"\");\n    const [firstName, setFirstName] = useState(userReducer.firstName);\n    const [lastName, setLastName] = useState(userReducer.lastName);\n    const [oldPassword, setOldPassword] = useState(\"\");\n    const [newPassword, setNewPassword] = useState(\"\");\n    const dispatch = useDispatch();\n    const [error, setError] = useState(\"\");\n    useEffect(() => {\n        // if (userReducer.username) {\n        //     setUserName(userReducer.username);\n        // }\n        if(userReducer.avatar){\n            setAvatar(userReducer.avatar);\n        }\n        // if(userReducer.gender) setGender(userReducer.gender);\n        // if (userReducer.birth_date) setBirthDate(userReducer.birth_date);\n    }, [userReducer]);\n    const handleChange = (event) => {\n        setGender(event.target.value);\n    };\n    const handleUpdateUser = async () => {\n        try {\n            // const birthDateISO = new Date(birthDate).toISOString();\n            const userInfo = await updateInfo(firstName, lastName, gender, birthDate, accessToken);\n            dispatch(saveUserInfo(userInfo));\n        } catch (error) {\n            console.error('Error fetching user info:', error);\n        }\n    }\n    const handleChangePassword = async () => {\n        console.log(\"DO DAY\")\n        setError(\"\");\n        if(oldPassword == \"\" || newPassword == \"\"){\n            setError(\"Do not enter current password or new password\");\n            return;\n        }\n        if(oldPassword === newPassword){\n            setError(\"The new password and old password must not be the same\");\n            return;\n        }\n        try {\n            const user = await changePassword(newPassword, oldPassword, accessToken, refreshToken)\n        } catch (error) {\n            setError(error.message);\n            console.error('Error change password:', error);\n        }\n    }\n    return (\n        <div className={\"my_account\"}>\n            <div className=\"bot_page__header\">\n                <div className=\"bot_page__title\">\n                    {/*<img src={knowledgeImage} alt=\"\"/>*/}\n                    <p className={\"title\"}>Tài khoản</p>\n                </div>\n            </div>\n            <div className=\"bot_page__body my_info--body\">\n                <div className=\"body__header\">\n                    <div className=\"avatar\">\n                        <img src={avatar} alt=\"\"/>\n                        <div className=\"btn_edit_avatar\">\n                            <i className=\"bi bi-pencil-fill\"></i>\n                        </div>\n                    </div>\n                </div>\n                <div className=\"body__content\">\n                    <div className=\"form_input\">\n                        <span className={\"title_form\"}>Thông tin người dùng</span>\n                        <InputModal value={firstName ? firstName : \"\"} onChangeInput={setFirstName} label={\"First name\"} placeHolder={\"Enter your first name\"}/>\n                        <InputModal value={lastName ? lastName : \"\"} onChangeInput={setLastName} label={\"Last name\"} placeHolder={\"Enter your last name\"}/>\n                        <div className=\"form_footer\">\n                            <label htmlFor=\"date\">Ngày sinh: </label>\n                            <input id=\"date\" onChange={(e)=> setBirthDate(e.target.value)} value={birthDate} type=\"date\"/>\n                            <label htmlFor=\"gender\">Giới tính:</label>\n                            <select id=\"gender\" value={gender} onChange={handleChange}>\n                                {/*<option value=\"option\">Choose gender</option>*/}\n                                <option value=\"male\">nam</option>\n                                <option value=\"female\">nu</option>\n                            </select>\n                        </div>\n                        <TextButtonIcon onPress={handleUpdateUser} title={\"Cập nhật\"} />\n                    </div>\n                    <div className=\"form_input\">\n                        <span className={\"title_form\"}>Thay đổi mật khẩu</span>\n                        <InputModal type={\"password\"} value={oldPassword} onChangeInput={setOldPassword} label={\"Mật khẩu hiện tại\"} placeHolder={\"Nhập mật khẩu hiện tại\"}/>\n                        <InputModal type={\"password\"} value={newPassword} onChangeInput={setNewPassword} label={\"Mật khẩu mới\"} placeHolder={\"Nhập mật khẩu mới\"}/>\n                        <p className=\"error\">{error}</p>\n                        <TextButtonIcon onPress={handleChangePassword} title={\"cập nhật\"} />\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}