{"ast":null,"code":"import\"./Files.scss\";import document from\"../../assets/images/dataset_text.png\";import TrFileItem from\"../tr_file_item/TrFileItem\";import NotificationDialog from\"../notification_dialog/NotificationDialog\";import{useEffect,useState}from\"react\";import UploadFileModal from\"../upload_file_modal/UploadFileModal\";import{useParams}from\"react-router-dom\";import{useDispatch,useSelector}from\"react-redux\";import{decryptToken}from\"../../utils/Functions\";import{addFileToKnowledge,deleteFileFromKnowledge,getFilesKnowledge}from\"../../services/KnowledgeService\";import{saveCurrentFiles}from\"../../store/actions/KnowledgeAction\";import Loading from\"../loading/Loading\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Files(){const{knowledgeId}=useParams();const[showDialog,setShowDialog]=useState(false);const[showUploadModal,setShowUploadModal]=useState(false);const[isLoading,setIsLoading]=useState(true);const dispatch=useDispatch();const accessToken=decryptToken(localStorage.getItem('access_token'));const files=useSelector(state=>{var _state$knowledgeReduc;return(_state$knowledgeReduc=state.knowledgeReducer.currentFileOfKnowledge)===null||_state$knowledgeReduc===void 0?void 0:_state$knowledgeReduc.files;});const[fileIdDelete,setFileIdDelete]=useState(\"\");useEffect(()=>{fetchData();},[accessToken]);const fetchData=async()=>{try{const data=await getFilesKnowledge(accessToken,knowledgeId);dispatch(saveCurrentFiles(data));setIsLoading(false);}catch(error){console.error('Error fetching knowledges:',error.message);}};const toggleShowUploadModal=()=>{setShowUploadModal(!showUploadModal);};const toggleShowDialog=id=>{setFileIdDelete(id);setShowDialog(!showDialog);};const handleUploadDatasets=async files=>{try{const data=await addFileToKnowledge(files,knowledgeId,accessToken);await fetchData();toggleShowUploadModal();}catch(error){console.error('Error upload file:',error.message);}};const handleDeleteDataset=async fileId=>{try{const data=await deleteFileFromKnowledge(fileId,knowledgeId,accessToken);await fetchData();toggleShowDialog(\"\");}catch(error){console.error('Delete file error:',error.message);}};return/*#__PURE__*/_jsx(_Fragment,{children:isLoading?/*#__PURE__*/_jsx(Loading,{}):/*#__PURE__*/_jsxs(\"div\",{className:\"bot_page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bot_page__header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bot_page__title\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"img_radius\",src:document,alt:\"\"}),/*#__PURE__*/_jsx(\"p\",{className:\"title\",children:\"Danh s\\xE1ch t\\xE0i li\\u1EC7u\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bot_page__btn\",children:/*#__PURE__*/_jsx(\"div\",{onClick:toggleShowUploadModal,className:\"btn_create_bot\",children:/*#__PURE__*/_jsx(\"p\",{className:\"btn_create_bot--text\",children:\"T\\u1EA3i t\\xE0i li\\u1EC7u l\\xEAn\"})})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bot_page__body\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table_wrapper\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"thead--border\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"T\\xE0i li\\u1EC7u\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Lo\\u1EA1i\"}),/*#__PURE__*/_jsx(\"th\",{children:\"K\\xEDch th\\u01B0\\u1EDBc\"}),/*#__PURE__*/_jsx(\"th\",{children:\"S\\u1ED1 l\\u01B0\\u1EE3ng \\u0111o\\u1EA1n\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Thao t\\xE1c\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:files.map(file=>{return/*#__PURE__*/_jsx(TrFileItem,{knowledgeId:knowledgeId,fileId:file.file_id,name:file.name,chunkCount:file.chunk_count,type:file.file_type,size:file.size,toggleShowDialog:()=>toggleShowDialog(file.file_id)},file.file_id);})})]})}),showDialog&&/*#__PURE__*/_jsx(NotificationDialog,{confirm:()=>handleDeleteDataset(fileIdDelete),title:\"Xác nhận xóa\",mesage:\"Bạn có chắc chắn muốn xóa tài liệu này?\",cancelDialog:toggleShowDialog}),showUploadModal&&/*#__PURE__*/_jsx(UploadFileModal,{confirm:handleUploadDatasets,toggleShow:toggleShowUploadModal})]})});}","map":{"version":3,"names":["document","TrFileItem","NotificationDialog","useEffect","useState","UploadFileModal","useParams","useDispatch","useSelector","decryptToken","addFileToKnowledge","deleteFileFromKnowledge","getFilesKnowledge","saveCurrentFiles","Loading","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Files","knowledgeId","showDialog","setShowDialog","showUploadModal","setShowUploadModal","isLoading","setIsLoading","dispatch","accessToken","localStorage","getItem","files","state","_state$knowledgeReduc","knowledgeReducer","currentFileOfKnowledge","fileIdDelete","setFileIdDelete","fetchData","data","error","console","message","toggleShowUploadModal","toggleShowDialog","id","handleUploadDatasets","handleDeleteDataset","fileId","children","className","src","alt","onClick","map","file","file_id","name","chunkCount","chunk_count","type","file_type","size","confirm","title","mesage","cancelDialog","toggleShow"],"sources":["/Users/huudan/Development/chatbot.com/fe/src/components/files/Files.js"],"sourcesContent":["import \"./Files.scss\"\nimport document from \"../../assets/images/dataset_text.png\";\nimport TrFileItem from \"../tr_file_item/TrFileItem\";\nimport NotificationDialog from \"../notification_dialog/NotificationDialog\";\nimport {useEffect, useState} from \"react\";\nimport UploadFileModal from \"../upload_file_modal/UploadFileModal\";\nimport {useParams} from \"react-router-dom\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {decryptToken} from \"../../utils/Functions\";\nimport {addFileToKnowledge, deleteFileFromKnowledge, getFilesKnowledge} from \"../../services/KnowledgeService\";\nimport {saveCurrentFiles} from \"../../store/actions/KnowledgeAction\";\nimport Loading from \"../loading/Loading\";\n\nexport default function Files() {\n    const { knowledgeId } = useParams();\n    const [showDialog, setShowDialog] = useState(false);\n    const [showUploadModal, setShowUploadModal] = useState(false);\n    const [isLoading, setIsLoading] = useState(true);\n    const dispatch = useDispatch();\n    const accessToken = decryptToken(localStorage.getItem('access_token'));\n    const files =  useSelector((state) => state.knowledgeReducer.currentFileOfKnowledge?.files);\n    const [fileIdDelete, setFileIdDelete] = useState(\"\");\n    useEffect(() => {\n        fetchData();\n    }, [accessToken]);\n    const fetchData = async () => {\n        try {\n            const data = await getFilesKnowledge(accessToken, knowledgeId);\n            dispatch(saveCurrentFiles(data));\n            setIsLoading(false);\n        } catch (error) {\n            console.error('Error fetching knowledges:', error.message);\n        }\n    };\n    const toggleShowUploadModal = ()=>{\n        setShowUploadModal(!showUploadModal);\n    }\n    const toggleShowDialog = (id) => {\n        setFileIdDelete(id);\n        setShowDialog(!showDialog);\n    }\n    const handleUploadDatasets = async (files) => {\n        try {\n            const data = await addFileToKnowledge(files, knowledgeId, accessToken);\n            await fetchData();\n            toggleShowUploadModal();\n        } catch (error) {\n            console.error('Error upload file:', error.message);\n        }\n    }\n    const handleDeleteDataset = async (fileId) => {\n        try {\n            const data = await deleteFileFromKnowledge(fileId, knowledgeId, accessToken);\n            await fetchData();\n            toggleShowDialog(\"\");\n        } catch (error) {\n            console.error('Delete file error:', error.message);\n        }\n    }\n    return (\n        <>\n            {isLoading ? <Loading/> : <div className={\"bot_page\"}>\n                <div className=\"bot_page__header\">\n                    <div className=\"bot_page__title\">\n                        <img className={\"img_radius\"} src={document} alt=\"\"/><p className={\"title\"}>Danh sách tài liệu</p>\n                    </div>\n                    <div  className=\"bot_page__btn\">\n                        <div onClick={toggleShowUploadModal} className={\"btn_create_bot\"}>\n                            <p className={\"btn_create_bot--text\"}>Tải tài liệu lên</p>\n                        </div>\n                    </div>\n                </div>\n                <div className=\"bot_page__body\">\n                    <table className={\"table_wrapper\"}>\n                        <thead className={\"thead--border\"}>\n                        <tr>\n                            <th>Tài liệu</th>\n                            <th>Loại</th>\n                            <th>Kích thước</th>\n                            <th>Số lượng đoạn</th>\n                            <th>Thao tác</th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        {\n                            files.map((file)=> {\n                                return <TrFileItem key={file.file_id} knowledgeId={knowledgeId} fileId={file.file_id} name={file.name} chunkCount={file.chunk_count} type={file.file_type} size={file.size} toggleShowDialog={()=>toggleShowDialog(file.file_id)}/>\n                            })\n                        }\n                        </tbody>\n                    </table>\n                </div>\n                {showDialog && <NotificationDialog confirm={()=>handleDeleteDataset(fileIdDelete)} title={\"Xác nhận xóa\"} mesage={\"Bạn có chắc chắn muốn xóa tài liệu này?\"}\n                                                   cancelDialog={toggleShowDialog}/>}\n                {showUploadModal && <UploadFileModal confirm={handleUploadDatasets} toggleShow={toggleShowUploadModal}/>}\n            </div>}\n        </>\n\n    )\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}