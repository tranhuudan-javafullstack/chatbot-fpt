{"ast":null,"code":"import\"./DocumentViewer.scss\";import document from\"../../assets/images/word.png\";import pdf from\"../../assets/images/pdf.png\";import bot from\"../../assets/images/bot.png\";import txt from\"../../assets/images/txt.png\";import{useEffect,useState}from\"react\";import sidebar from\"../../assets/icons/sidebar.png\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function DocumentViewer(_ref){let{chats,showContext,setShowContext}=_ref;const[dropdownStates,setDropdownStates]=useState({});const[filesContext,setFilesContext]=useState({});useEffect(()=>{if(chats.length>0){setFilesContext(groupChunksByFileAndKnowledge(chats[chats.length-1].question.chunks));}else{setFilesContext({});}},[chats]);const getFileImage=fileType=>{if(fileType==\"docx\")return document;if(fileType==\"pdf\")return pdf;return txt;};const groupChunksByFileAndKnowledge=chunks=>{const groupedChunks={};chunks.forEach(chunk=>{const key=\"\".concat(chunk.file_name,\"-\").concat(chunk.knowledge_name);if(!groupedChunks[key]){groupedChunks[key]=[];}groupedChunks[key].push(chunk);});return groupedChunks;};const toggleDropdown=id=>{setDropdownStates(prevState=>({...prevState,[id]:!prevState[id]}));};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{onClick:()=>setShowContext(!showContext),className:\"btn_toggle_context \".concat(showContext?\"\":\"btn_toggle_context--transform\",\" \"),children:/*#__PURE__*/_jsx(\"img\",{src:sidebar,alt:\"\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat_area document_viewer \".concat(showContext?\"\":\" document--hidden\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"chat_area__title\",children:/*#__PURE__*/_jsx(\"span\",{children:\"Document viewer\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"chat_area__message document_viewer\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"document_viewer__body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header_tag\",children:[/*#__PURE__*/_jsx(\"img\",{src:bot,alt:\"\"}),/*#__PURE__*/_jsx(\"span\",{className:\"\",children:\"Context Used\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"context_used__container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"context\",children:Object.keys(filesContext).map((key,index)=>{const chunk=filesContext[key][0];return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"document_viewer__header\",children:/*#__PURE__*/_jsx(\"div\",{className:\"document_relate__container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"document_relate\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"document_relate__image\",children:/*#__PURE__*/_jsx(\"img\",{src:getFileImage(chunk.file_type),alt:\"\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"document_relate__info\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"title\",children:chunk.file_name}),/*#__PURE__*/_jsxs(\"span\",{className:\"sub_content\",children:[\"from knowledge \",chunk.knowledge_name]})]}),/*#__PURE__*/_jsx(\"div\",{title:\"Show detail chunks\",onClick:()=>toggleDropdown(index),className:\"btn_show\",children:/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-caret-down-fill\"})})})]})})}),dropdownStates[index]&&/*#__PURE__*/_jsx(\"div\",{className:\"dropdown-content\",children:filesContext[key].map((chunk,chunkIndex)=>{return/*#__PURE__*/_jsx(\"p\",{className:\"chunk\",children:chunk.chunks},chunk.chunk_id);})})]},index);})})})]})})]})]});}","map":{"version":3,"names":["document","pdf","bot","txt","useEffect","useState","sidebar","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","DocumentViewer","_ref","chats","showContext","setShowContext","dropdownStates","setDropdownStates","filesContext","setFilesContext","length","groupChunksByFileAndKnowledge","question","chunks","getFileImage","fileType","groupedChunks","forEach","chunk","key","concat","file_name","knowledge_name","push","toggleDropdown","id","prevState","children","onClick","className","src","alt","Object","keys","map","index","file_type","title","chunkIndex","chunk_id"],"sources":["/Users/huudan/Development/chatbot.com/fe/src/components/document_viewer/DocumentViewer.js"],"sourcesContent":["import \"./DocumentViewer.scss\"\nimport document from \"../../assets/images/word.png\";\nimport pdf from \"../../assets/images/pdf.png\";\nimport bot from \"../../assets/images/bot.png\";\nimport txt from \"../../assets/images/txt.png\";\n\nimport {useEffect, useState} from \"react\";\nimport sidebar from \"../../assets/icons/sidebar.png\";\n\nexport default function DocumentViewer({chats, showContext, setShowContext}) {\n    const [dropdownStates, setDropdownStates] = useState({});\n    const [filesContext, setFilesContext] = useState({});\n    useEffect(() => {\n        if(chats.length > 0 ){\n            setFilesContext(groupChunksByFileAndKnowledge(chats[chats.length - 1].question.chunks));\n        }else{\n            setFilesContext({});\n        }\n    }, [chats]);\n    const getFileImage = (fileType) => {\n        if(fileType == \"docx\") return document;\n        if(fileType == \"pdf\") return pdf;\n        return txt;\n    }\n    const groupChunksByFileAndKnowledge = (chunks) => {\n        const groupedChunks = {};\n        chunks.forEach((chunk) => {\n            const key = `${chunk.file_name}-${chunk.knowledge_name}`;\n            if (!groupedChunks[key]) {\n                groupedChunks[key] = [];\n            }\n            groupedChunks[key].push(chunk);\n        });\n        return groupedChunks;\n    };\n    const toggleDropdown = (id) => {\n        setDropdownStates((prevState) => ({\n            ...prevState,\n            [id]: !prevState[id],\n        }));\n    };\n    return (\n        <>\n            <div onClick={()=>setShowContext(!showContext)} className={`btn_toggle_context ${showContext ? \"\" :\"btn_toggle_context--transform\"} `}>\n                <img src={sidebar} alt=\"\"/>\n            </div>\n            <div className={`chat_area document_viewer ${showContext ? \"\" : \" document--hidden\"}`}>\n                <div className=\"chat_area__title\">\n                    <span>Document viewer</span>\n                </div>\n                <div className=\"chat_area__message document_viewer\">\n                    <div className=\"document_viewer__body\">\n                        <div className=\"header_tag\">\n                            <img src={bot} alt=\"\"/>\n                            <span className={\"\"}>Context Used</span>\n                        </div>\n                        <div className=\"context_used__container\">\n                            <div className=\"context\">\n                                {Object.keys(filesContext).map((key, index)=>{\n                                    const chunk = filesContext[key][0];\n                                    return <div key={index}>\n                                        <div  className=\"document_viewer__header\">\n                                            <div className=\"document_relate__container\">\n                                                <div className=\"document_relate\">\n                                                    <div className=\"document_relate__image\">\n                                                        <img src={getFileImage(chunk.file_type)} alt=\"\"/>\n                                                    </div>\n                                                    <div className=\"document_relate__info\">\n                                                        <span className=\"title\">{chunk.file_name}</span>\n                                                        <span className=\"sub_content\">\n                                                        from knowledge {chunk.knowledge_name}\n                                                    </span>\n                                                    </div>\n                                                    <div title={\"Show detail chunks\"} onClick={() => toggleDropdown(index)} className=\"btn_show\">\n                                                        <span><i className=\"bi bi-caret-down-fill\"></i></span>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                        {dropdownStates[index] && (\n                                            <div className=\"dropdown-content\">\n                                                {filesContext[key].map((chunk, chunkIndex)=>{\n                                                    return <p key={chunk.chunk_id} className=\"chunk\">{chunk.chunks}</p>\n                                                })}\n                                            </div>\n                                        )}\n                                    </div>\n\n                                })}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </>\n\n    )\n}"],"mappings":"AAAA,MAAO,uBAAuB,CAC9B,MAAO,CAAAA,QAAQ,KAAM,8BAA8B,CACnD,MAAO,CAAAC,GAAG,KAAM,6BAA6B,CAC7C,MAAO,CAAAC,GAAG,KAAM,6BAA6B,CAC7C,MAAO,CAAAC,GAAG,KAAM,6BAA6B,CAE7C,OAAQC,SAAS,CAAEC,QAAQ,KAAO,OAAO,CACzC,MAAO,CAAAC,OAAO,KAAM,gCAAgC,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAErD,cAAe,SAAS,CAAAC,cAAcA,CAAAC,IAAA,CAAuC,IAAtC,CAACC,KAAK,CAAEC,WAAW,CAAEC,cAAc,CAAC,CAAAH,IAAA,CACvE,KAAM,CAACI,cAAc,CAAEC,iBAAiB,CAAC,CAAGd,QAAQ,CAAC,CAAC,CAAC,CAAC,CACxD,KAAM,CAACe,YAAY,CAAEC,eAAe,CAAC,CAAGhB,QAAQ,CAAC,CAAC,CAAC,CAAC,CACpDD,SAAS,CAAC,IAAM,CACZ,GAAGW,KAAK,CAACO,MAAM,CAAG,CAAC,CAAE,CACjBD,eAAe,CAACE,6BAA6B,CAACR,KAAK,CAACA,KAAK,CAACO,MAAM,CAAG,CAAC,CAAC,CAACE,QAAQ,CAACC,MAAM,CAAC,CAAC,CAC3F,CAAC,IAAI,CACDJ,eAAe,CAAC,CAAC,CAAC,CAAC,CACvB,CACJ,CAAC,CAAE,CAACN,KAAK,CAAC,CAAC,CACX,KAAM,CAAAW,YAAY,CAAIC,QAAQ,EAAK,CAC/B,GAAGA,QAAQ,EAAI,MAAM,CAAE,MAAO,CAAA3B,QAAQ,CACtC,GAAG2B,QAAQ,EAAI,KAAK,CAAE,MAAO,CAAA1B,GAAG,CAChC,MAAO,CAAAE,GAAG,CACd,CAAC,CACD,KAAM,CAAAoB,6BAA6B,CAAIE,MAAM,EAAK,CAC9C,KAAM,CAAAG,aAAa,CAAG,CAAC,CAAC,CACxBH,MAAM,CAACI,OAAO,CAAEC,KAAK,EAAK,CACtB,KAAM,CAAAC,GAAG,IAAAC,MAAA,CAAMF,KAAK,CAACG,SAAS,MAAAD,MAAA,CAAIF,KAAK,CAACI,cAAc,CAAE,CACxD,GAAI,CAACN,aAAa,CAACG,GAAG,CAAC,CAAE,CACrBH,aAAa,CAACG,GAAG,CAAC,CAAG,EAAE,CAC3B,CACAH,aAAa,CAACG,GAAG,CAAC,CAACI,IAAI,CAACL,KAAK,CAAC,CAClC,CAAC,CAAC,CACF,MAAO,CAAAF,aAAa,CACxB,CAAC,CACD,KAAM,CAAAQ,cAAc,CAAIC,EAAE,EAAK,CAC3BlB,iBAAiB,CAAEmB,SAAS,GAAM,CAC9B,GAAGA,SAAS,CACZ,CAACD,EAAE,EAAG,CAACC,SAAS,CAACD,EAAE,CACvB,CAAC,CAAC,CAAC,CACP,CAAC,CACD,mBACI3B,KAAA,CAAAE,SAAA,EAAA2B,QAAA,eACI/B,IAAA,QAAKgC,OAAO,CAAEA,CAAA,GAAIvB,cAAc,CAAC,CAACD,WAAW,CAAE,CAACyB,SAAS,uBAAAT,MAAA,CAAwBhB,WAAW,CAAG,EAAE,CAAE,+BAA+B,KAAI,CAAAuB,QAAA,cAClI/B,IAAA,QAAKkC,GAAG,CAAEpC,OAAQ,CAACqC,GAAG,CAAC,EAAE,CAAC,CAAC,CAC1B,CAAC,cACNjC,KAAA,QAAK+B,SAAS,8BAAAT,MAAA,CAA+BhB,WAAW,CAAG,EAAE,CAAG,mBAAmB,CAAG,CAAAuB,QAAA,eAClF/B,IAAA,QAAKiC,SAAS,CAAC,kBAAkB,CAAAF,QAAA,cAC7B/B,IAAA,SAAA+B,QAAA,CAAM,iBAAe,CAAM,CAAC,CAC3B,CAAC,cACN/B,IAAA,QAAKiC,SAAS,CAAC,oCAAoC,CAAAF,QAAA,cAC/C7B,KAAA,QAAK+B,SAAS,CAAC,uBAAuB,CAAAF,QAAA,eAClC7B,KAAA,QAAK+B,SAAS,CAAC,YAAY,CAAAF,QAAA,eACvB/B,IAAA,QAAKkC,GAAG,CAAExC,GAAI,CAACyC,GAAG,CAAC,EAAE,CAAC,CAAC,cACvBnC,IAAA,SAAMiC,SAAS,CAAE,EAAG,CAAAF,QAAA,CAAC,cAAY,CAAM,CAAC,EACvC,CAAC,cACN/B,IAAA,QAAKiC,SAAS,CAAC,yBAAyB,CAAAF,QAAA,cACpC/B,IAAA,QAAKiC,SAAS,CAAC,SAAS,CAAAF,QAAA,CACnBK,MAAM,CAACC,IAAI,CAACzB,YAAY,CAAC,CAAC0B,GAAG,CAAC,CAACf,GAAG,CAAEgB,KAAK,GAAG,CACzC,KAAM,CAAAjB,KAAK,CAAGV,YAAY,CAACW,GAAG,CAAC,CAAC,CAAC,CAAC,CAClC,mBAAOrB,KAAA,QAAA6B,QAAA,eACH/B,IAAA,QAAMiC,SAAS,CAAC,yBAAyB,CAAAF,QAAA,cACrC/B,IAAA,QAAKiC,SAAS,CAAC,4BAA4B,CAAAF,QAAA,cACvC7B,KAAA,QAAK+B,SAAS,CAAC,iBAAiB,CAAAF,QAAA,eAC5B/B,IAAA,QAAKiC,SAAS,CAAC,wBAAwB,CAAAF,QAAA,cACnC/B,IAAA,QAAKkC,GAAG,CAAEhB,YAAY,CAACI,KAAK,CAACkB,SAAS,CAAE,CAACL,GAAG,CAAC,EAAE,CAAC,CAAC,CAChD,CAAC,cACNjC,KAAA,QAAK+B,SAAS,CAAC,uBAAuB,CAAAF,QAAA,eAClC/B,IAAA,SAAMiC,SAAS,CAAC,OAAO,CAAAF,QAAA,CAAET,KAAK,CAACG,SAAS,CAAO,CAAC,cAChDvB,KAAA,SAAM+B,SAAS,CAAC,aAAa,CAAAF,QAAA,EAAC,iBACf,CAACT,KAAK,CAACI,cAAc,EAClC,CAAC,EACF,CAAC,cACN1B,IAAA,QAAKyC,KAAK,CAAE,oBAAqB,CAACT,OAAO,CAAEA,CAAA,GAAMJ,cAAc,CAACW,KAAK,CAAE,CAACN,SAAS,CAAC,UAAU,CAAAF,QAAA,cACxF/B,IAAA,SAAA+B,QAAA,cAAM/B,IAAA,MAAGiC,SAAS,CAAC,uBAAuB,CAAI,CAAC,CAAM,CAAC,CACrD,CAAC,EACL,CAAC,CACL,CAAC,CACL,CAAC,CACLvB,cAAc,CAAC6B,KAAK,CAAC,eAClBvC,IAAA,QAAKiC,SAAS,CAAC,kBAAkB,CAAAF,QAAA,CAC5BnB,YAAY,CAACW,GAAG,CAAC,CAACe,GAAG,CAAC,CAAChB,KAAK,CAAEoB,UAAU,GAAG,CACxC,mBAAO1C,IAAA,MAAwBiC,SAAS,CAAC,OAAO,CAAAF,QAAA,CAAET,KAAK,CAACL,MAAM,EAA/CK,KAAK,CAACqB,QAA6C,CAAC,CACvE,CAAC,CAAC,CACD,CACR,GAzBYJ,KA0BZ,CAAC,CAEV,CAAC,CAAC,CACD,CAAC,CACL,CAAC,EACL,CAAC,CACL,CAAC,EACL,CAAC,EACR,CAAC,CAGX","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}